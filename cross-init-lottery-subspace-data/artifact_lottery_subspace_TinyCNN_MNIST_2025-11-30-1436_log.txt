Starting log with name artifact_lottery_subspace_TinyCNN_MNIST_2025-11-30-1436

==== Diffs ====
 data_utils.py            |  18 ++++++++++++------
 freedomResearchPaper.pdf | Bin 9738957 -> 0 bytes
 lottery_subspace.py      |   8 +++++---
 training_utils.py        |   5 +++--
 4 files changed, 20 insertions(+), 11 deletions(-)
==== End Diffs ====

--- Running with Python3.8 --- 

 Package                Version
---------------------- ---------------------
absl-py                0.10.0
astunparse             1.6.3
cachetools             4.2.4
certifi                2025.11.12
charset-normalizer     3.4.4
cycler                 0.12.1
flatbuffers            1.12
flax                   0.2.0
gast                   0.3.3
google-auth            1.35.0
google-auth-oauthlib   0.4.6
google-pasta           0.2.0
grpcio                 1.32.0
h5py                   2.10.0
idna                   3.11
importlib_metadata     8.5.0
jax                    0.2.21
jaxlib                 0.1.74+cuda11.cudnn82
Keras                  2.4.3
Keras-Preprocessing    1.1.2
kiwisolver             1.4.7
Markdown               3.7
MarkupSafe             2.1.5
matplotlib             3.3.4
mkl-fft                1.3.8
mkl-random             1.2.4
mkl-service            2.4.0
msgpack                1.1.1
numpy                  1.19.5
oauthlib               3.3.1
opt-einsum             3.3.0
pillow                 10.4.0
pip                    24.2
protobuf               3.13.0
pyasn1                 0.6.1
pyasn1_modules         0.4.2
pyparsing              3.1.4
python-dateutil        2.9.0.post0
PyYAML                 6.0.3
requests               2.32.4
requests-oauthlib      2.0.0
rsa                    4.9.1
scipy                  1.5.4
setuptools             75.1.0
six                    1.15.0
tensorboard            2.4.1
tensorboard-plugin-wit 1.8.0
tensorflow-cpu         2.4.3
tensorflow-estimator   2.4.0
termcolor              1.1.0
typing-extensions      3.7.4
urllib3                2.2.3
Werkzeug               3.0.6
wheel                  0.44.0
wrapt                  1.12.1
zipp                   3.20.2
 

 ---CUDA Details---

 
NVRM version: NVIDIA UNIX x86_64 Kernel Module  580.82.09  Fri Aug 29 17:44:50 UTC 2025
GCC version:  gcc version 15.2.1 20250813 (GCC) 

 ---Code Output---

[Lottery Subspace] Subspace formed from directions in training trajectory: 

Dimensions to Explore: [8, 32, 128, 512, 1024, 2048] 
Model: TinyCNN 
Dataset: MNIST 
Optimization Algorithm: Adam with learning rate 5.00e-02 
Spacing for saving out directions in trajectory: 5 Iterations 
No sparsity restrictions on projection matrix. 
Collect 1 points for each dimension (Random seed starting at 0). 
Run optimization for 3 epochs. 

Starting log with name artifact_lottery_subspace_TinyCNN_MNIST_2025-11-30-1436

==== Diffs ====
 data_utils.py            |  18 ++++++++++++------
 freedomResearchPaper.pdf | Bin 9738957 -> 0 bytes
 lottery_subspace.py      |   8 +++++---
 training_utils.py        |   5 +++--
 4 files changed, 20 insertions(+), 11 deletions(-)
==== End Diffs ====

--- Running with Python3.8 --- 

 Package                Version
---------------------- ---------------------
absl-py                0.10.0
astunparse             1.6.3
cachetools             4.2.4
certifi                2025.11.12
charset-normalizer     3.4.4
cycler                 0.12.1
flatbuffers            1.12
flax                   0.2.0
gast                   0.3.3
google-auth            1.35.0
google-auth-oauthlib   0.4.6
google-pasta           0.2.0
grpcio                 1.32.0
h5py                   2.10.0
idna                   3.11
importlib_metadata     8.5.0
jax                    0.2.21
jaxlib                 0.1.74+cuda11.cudnn82
Keras                  2.4.3
Keras-Preprocessing    1.1.2
kiwisolver             1.4.7
Markdown               3.7
MarkupSafe             2.1.5
matplotlib             3.3.4
mkl-fft                1.3.8
mkl-random             1.2.4
mkl-service            2.4.0
msgpack                1.1.1
numpy                  1.19.5
oauthlib               3.3.1
opt-einsum             3.3.0
pillow                 10.4.0
pip                    24.2
protobuf               3.13.0
pyasn1                 0.6.1
pyasn1_modules         0.4.2
pyparsing              3.1.4
python-dateutil        2.9.0.post0
PyYAML                 6.0.3
requests               2.32.4
requests-oauthlib      2.0.0
rsa                    4.9.1
scipy                  1.5.4
setuptools             75.1.0
six                    1.15.0
tensorboard            2.4.1
tensorboard-plugin-wit 1.8.0
tensorflow-cpu         2.4.3
tensorflow-estimator   2.4.0
termcolor              1.1.0
typing-extensions      3.7.4
urllib3                2.2.3
Werkzeug               3.0.6
wheel                  0.44.0
wrapt                  1.12.1
zipp                   3.20.2
 

 ---CUDA Details---

 
NVRM version: NVIDIA UNIX x86_64 Kernel Module  580.82.09  Fri Aug 29 17:44:50 UTC 2025
GCC version:  gcc version 15.2.1 20250813 (GCC) 

 ---Code Output---

[Lottery Subspace] Subspace formed from directions in training trajectory: 

Dimensions to Explore: [8, 32, 128, 512, 1024, 2048] 
Model: TinyCNN 
Dataset: MNIST 
Optimization Algorithm: Adam with learning rate 5.00e-02 
Spacing for saving out directions in trajectory: 5 Iterations 
No sparsity restrictions on projection matrix. 
Collect 1 points for each dimension (Random seed starting at 0). 
Run optimization for 3 epochs. 


-----------------------------------------------------------------------------------------------
Run Number 0
Number of params = 20490   subspace d=8
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.0       0         0.14142106     2.3024664      0.08595        2.2992933      0.091299996    
0.107     50        3.5961072      0.44770142     0.90625        -              -              
0.213     100       3.971567       0.39605853     0.8203125      -              -              
0.32      150       4.0500426      0.33007        0.8984375      -              -              
0.427     200       4.0675735      0.5584674      0.8671875      -              -              
0.533     250       4.088002       0.44722292     0.8828125      -              -              
0.64      300       4.1406045      0.36763847     0.8984375      -              -              
0.747     350       4.187225       0.43830317     0.859375       -              -              
0.853     400       4.1448336      0.42742053     0.9140625      -              -              
0.96      450       4.156611       0.3024019      0.8828125      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.998     468       4.1782646      0.3960612      0.8835667      0.38437694     0.88629997     
1.067     500       4.1409936      0.37668407     0.875          -              -              
1.173     550       4.102228       0.30641735     0.9140625      -              -              
1.28      600       4.1257854      0.29033458     0.90625        -              -              
1.387     650       4.129683       0.33191615     0.859375       -              -              
1.493     700       4.096229       0.37290597     0.9140625      -              -              
1.6       750       4.123795       0.2832395      0.9296875      -              -              
1.707     800       4.085493       0.30380687     0.90625        -              -              
1.813     850       4.085959       0.35367247     0.90625        -              -              
1.92      900       4.117306       0.4615749      0.859375       -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
1.997     936       4.1553807      0.38489208     0.88926667     0.37120402     0.89309996     
2.027     950       4.165592       0.4007188      0.8984375      -              -              
2.133     1000      4.1450043      0.38719982     0.8828125      -              -              
2.24      1050      4.0792003      0.33813477     0.90625        -              -              
2.347     1100      4.104086       0.29969478     0.90625        -              -              
2.453     1150      4.1277037      0.50730205     0.8671875      -              -              
2.56      1200      4.1352725      0.3081305      0.9140625      -              -              
2.667     1250      4.1262717      0.32130674     0.9296875      -              -              
2.773     1300      4.0895567      0.3611537      0.921875       -              -              
2.88      1350      4.117059       0.45895112     0.875          -              -              
2.987     1400      4.1257014      0.21348435     0.9375         -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
2.995     1404      4.146235       0.3898991      0.88776666     0.3777755      0.8918         

Total time:                     22.13213062286377
Avg time to compute gradient:   0.011564028881590842
Avg time to project theta:      0.002755746488971073

-----------------------------------------------------------------------------------------------
Run Number 0
Number of params = 20490   subspace d=32
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.0       0         0.2828414      2.2553067      0.2141         2.249893       0.22649999     
0.107     50        3.7789888      0.6994759      0.8203125      -              -              
0.213     100       4.2647448      0.26898795     0.9375         -              -              
0.32      150       5.0476317      0.15496755     0.96875        -              -              
0.427     200       5.9875574      0.15298772     0.96875        -              -              
0.533     250       6.63786        0.072756045    0.984375       -              -              
0.64      300       7.101596       0.09257244     0.9765625      -              -              
0.747     350       7.470225       0.10521197     0.9609375      -              -              
0.853     400       7.7058415      0.11478378     0.9609375      -              -              
0.96      450       7.893748       0.04918358     0.9921875      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.998     468       7.9645653      0.09934068     0.9711667      0.09062313     0.9727         
1.067     500       8.026204       0.046826337    0.9921875      -              -              
1.173     550       8.198484       0.044742666    0.9921875      -              -              
1.28      600       8.303872       0.06017261     0.984375       -              -              
1.387     650       8.437378       0.14970261     0.9609375      -              -              
1.493     700       8.500934       0.089556605    0.984375       -              -              
1.6       750       8.5538845      0.13241512     0.953125       -              -              
1.707     800       8.618343       0.08290452     0.96875        -              -              
1.813     850       8.669623       0.08437663     0.96875        -              -              
1.92      900       8.719939       0.04528962     0.9765625      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
1.997     936       8.749055       0.09600988     0.97083336     0.086129114    0.97419995     
2.027     950       8.725528       0.051219255    0.984375       -              -              
2.133     1000      8.791367       0.29505438     0.9453125      -              -              
2.24      1050      8.832989       0.072520405    0.9609375      -              -              
2.347     1100      8.892917       0.101520985    0.96875        -              -              
2.453     1150      8.889645       0.1134534      0.953125       -              -              
2.56      1200      8.878082       0.11052051     0.96875        -              -              
2.667     1250      8.914142       0.055721745    0.9765625      -              -              
2.773     1300      8.979918       0.0733437      0.96875        -              -              
2.88      1350      9.000889       0.101952       0.9765625      -              -              
2.987     1400      9.009226       0.024498023    0.9921875      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
2.995     1404      9.013955       0.09680894     0.97065        0.084974505    0.9737         

Total time:                     25.495322227478027
Avg time to compute gradient:   0.011432430467964829
Avg time to project theta:      0.0051655738846833775

-----------------------------------------------------------------------------------------------
Run Number 0
Number of params = 20490   subspace d=128
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.0       0         0.5656694      2.2554278      0.101783335    2.250829       0.1003         
0.107     50        7.212828       0.6346246      0.78125        -              -              
0.213     100       7.5111704      0.41276005     0.8828125      -              -              
0.32      150       7.687545       0.23604038     0.9296875      -              -              
0.427     200       7.8317637      0.34911817     0.8984375      -              -              
0.533     250       8.073893       0.32937324     0.8828125      -              -              
0.64      300       8.35059        0.27613354     0.921875       -              -              
0.747     350       8.581431       0.2728087      0.921875       -              -              
0.853     400       8.871807       0.23139445     0.9375         -              -              
0.96      450       9.077524       0.062619284    0.96875        -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.998     468       9.131174       0.11450625     0.9653         0.09602245     0.96989995     
1.067     500       9.232648       0.05677217     0.984375       -              -              
1.173     550       9.362771       0.05198783     0.9921875      -              -              
1.28      600       9.549421       0.05949442     0.984375       -              -              
1.387     650       9.680646       0.054705314    0.984375       -              -              
1.493     700       9.818367       0.04277453     0.984375       -              -              
1.6       750       9.936688       0.09187388     0.96875        -              -              
1.707     800       10.102153      0.042714644    0.9921875      -              -              
1.813     850       10.267591      0.19752671     0.96875        -              -              
1.92      900       10.426481      0.062792346    0.9765625      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
1.997     936       10.525669      0.059428237    0.9825167      0.055975944    0.982          
2.027     950       10.587973      0.06520021     0.984375       -              -              
2.133     1000      10.718424      0.011974192    1.0            -              -              
2.24      1050      10.845026      0.018809142    1.0            -              -              
2.347     1100      10.9928665     0.05352908     0.984375       -              -              
2.453     1150      11.118153      0.019421741    1.0            -              -              
2.56      1200      11.256021      0.09051602     0.9765625      -              -              
2.667     1250      11.398136      0.036701985    0.984375       -              -              
2.773     1300      11.530358      0.027507417    0.9921875      -              -              
2.88      1350      11.673033      0.029819794    1.0            -              -              
2.987     1400      11.812067      0.016592357    1.0            -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
2.995     1404      11.825185      0.04136852     0.98721665     0.046114173    0.9838         

Total time:                     40.43532180786133
Avg time to compute gradient:   0.013949245955813584
Avg time to project theta:      0.01322680902379408

-----------------------------------------------------------------------------------------------
Run Number 0
Number of params = 20490   subspace d=512
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.0       0         1.1312834      2.3939676      0.09751667     2.3940156      0.097399995    
0.107     50        12.566783      0.6221488      0.7734375      -              -              
0.213     100       13.710365      0.3557376      0.8984375      -              -              
0.32      150       14.270695      0.40979975     0.8984375      -              -              
0.427     200       14.777152      0.19630706     0.9375         -              -              
0.533     250       15.070216      0.24004486     0.921875       -              -              
0.64      300       15.30318       0.25345632     0.921875       -              -              
0.747     350       15.506333      0.12760468     0.9609375      -              -              
0.853     400       15.643072      0.1413612      0.9765625      -              -              
0.96      450       15.806642      0.16135469     0.9453125      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.998     468       15.887739      0.17464569     0.94925        0.15904658     0.9528         
1.067     500       16.011429      0.09938027     0.9609375      -              -              
1.173     550       16.142715      0.16804308     0.953125       -              -              
1.28      600       16.344797      0.16625275     0.9375         -              -              
1.387     650       16.357143      0.15482968     0.9609375      -              -              
1.493     700       16.487038      0.11986292     0.9609375      -              -              
1.6       750       16.523203      0.07242233     0.984375       -              -              
1.707     800       16.629274      0.047864564    0.9921875      -              -              
1.813     850       16.69156       0.09246974     0.9765625      -              -              
1.92      900       16.735226      0.113355234    0.9609375      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
1.997     936       16.775324      0.12893467     0.96095        0.116309784    0.9641         
2.027     950       16.761477      0.17999633     0.953125       -              -              
2.133     1000      16.79682       0.17638932     0.96875        -              -              
2.24      1050      16.80795       0.09243113     0.9765625      -              -              
2.347     1100      16.841188      0.09289713     0.96875        -              -              
2.453     1150      16.91582       0.13387698     0.984375       -              -              
2.56      1200      16.930246      0.07478919     0.96875        -              -              
2.667     1250      16.92732       0.091004774    0.9609375      -              -              
2.773     1300      16.979874      0.100429535    0.953125       -              -              
2.88      1350      16.99937       0.09528807     0.953125       -              -              
2.987     1400      17.01339       0.07060572     0.984375       -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
2.995     1404      17.027405      0.0949877      0.97165        0.086249195    0.9726         

Total time:                     175.99792623519897
Avg time to compute gradient:   0.028089624647562098
Avg time to project theta:      0.09560656208642934

-----------------------------------------------------------------------------------------------
Run Number 0
Number of params = 20490   subspace d=1024
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.0       0         1.5999261      2.6838334      0.107983336    2.6876762      0.1085         
0.107     50        17.355352      0.25644547     0.9296875      -              -              
0.213     100       18.6942        0.3199373      0.890625       -              -              
0.32      150       19.469849      0.16830742     0.953125       -              -              
0.427     200       20.131607      0.18408641     0.9140625      -              -              
0.533     250       20.705511      0.26219505     0.9453125      -              -              
0.64      300       21.13303       0.1510258      0.953125       -              -              
0.747     350       21.521513      0.13363086     0.9609375      -              -              
0.853     400       21.89041       0.16181287     0.9609375      -              -              
0.96      450       22.077394      0.14418368     0.96875        -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.998     468       22.21671       0.1361477      0.9598667      0.12809338     0.96169996     
1.067     500       22.388466      0.08289459     0.9609375      -              -              
1.173     550       22.663525      0.13876933     0.9453125      -              -              
1.28      600       22.975843      0.09468182     0.96875        -              -              
1.387     650       23.273998      0.29864872     0.9609375      -              -              
1.493     700       23.466238      0.1000876      0.96875        -              -              
1.6       750       23.722769      0.10170655     0.96875        -              -              
1.707     800       23.930992      0.12486733     0.96875        -              -              
1.813     850       24.130756      0.14897628     0.96875        -              -              
1.92      900       24.335472      0.07189793     0.984375       -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
1.997     936       24.43239       0.11038955     0.9676         0.1034406      0.9668         
2.027     950       24.516998      0.068906605    0.984375       -              -              
2.133     1000      24.69339       0.078069806    0.96875        -              -              
2.24      1050      24.869291      0.07498765     0.9921875      -              -              
2.347     1100      25.05571       0.09845984     0.9453125      -              -              
2.453     1150      25.269081      0.12165932     0.9609375      -              -              
2.56      1200      25.407164      0.07004572     0.96875        -              -              
2.667     1250      25.58334       0.11836897     0.96875        -              -              
2.773     1300      25.814466      0.05714654     0.9765625      -              -              
2.88      1350      25.92552       0.08970618     0.9609375      -              -              
2.987     1400      26.052496      0.06744699     0.9765625      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
2.995     1404      26.066708      0.098877564    0.9699         0.09382748     0.97139996     

Total time:                     344.68719935417175
Avg time to compute gradient:   0.045949630052719716
Avg time to project theta:      0.19775592865635508

-----------------------------------------------------------------------------------------------
Run Number 0
Number of params = 20490   subspace d=2048
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.0       0         2.262316       2.9936495      0.09871667     2.983754       0.098          
0.107     50        23.61789       0.2965818      0.9296875      -              -              
0.213     100       25.320265      0.15064839     0.953125       -              -              
0.32      150       25.991892      0.24010676     0.9296875      -              -              
0.427     200       26.657766      0.16069004     0.953125       -              -              
0.533     250       27.166857      0.14762852     0.953125       -              -              
0.64      300       27.69877       0.09969181     0.96875        -              -              
0.747     350       28.159445      0.08242079     0.96875        -              -              
0.853     400       28.641394      0.1314016      0.953125       -              -              
0.96      450       29.017206      0.118856266    0.9765625      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
0.998     468       29.184986      0.104816474    0.96945        0.09059903     0.9712         
1.067     500       29.352926      0.089148946    0.96875        -              -              
1.173     550       29.714455      0.085461795    0.984375       -              -              
1.28      600       30.014627      0.0635428      0.984375       -              -              
1.387     650       30.411161      0.13400653     0.96875        -              -              
1.493     700       30.645752      0.08810073     0.96875        -              -              
1.6       750       31.086609      0.15606277     0.9609375      -              -              
1.707     800       31.411436      0.07670633     0.984375       -              -              
1.813     850       31.70888       0.07622411     0.9609375      -              -              
1.92      900       31.918392      0.08270386     0.9453125      -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
1.997     936       32.159508      0.08088169     0.97495        0.076004304    0.9751         
2.027     950       32.271004      0.054679982    0.984375       -              -              
2.133     1000      32.4865        0.08223264     0.9609375      -              -              
2.24      1050      32.82247       0.036584254    0.9921875      -              -              
2.347     1100      33.020912      0.043834273    0.984375       -              -              
2.453     1150      33.367695      0.13961007     0.96875        -              -              
2.56      1200      33.609997      0.057420492    0.9765625      -              -              
2.667     1250      33.825302      0.06063141     0.9765625      -              -              
2.773     1300      34.04744       0.11391014     0.953125       -              -              
2.88      1350      34.300182      0.10759993     0.9765625      -              -              
2.987     1400      34.587757      0.0392633      0.984375       -              -              
epoch     iter      |theta|        train loss     train acc      test loss      test acc       
2.995     1404      34.60296       0.0632204      0.98045003     0.060926963    0.9802         

Total time:                     674.3380107879639
Avg time to compute gradient:   0.08421613073721793
Avg time to project theta:      0.3941269764768035
